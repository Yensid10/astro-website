---
import Navbar from './Navbar'

export interface Props {
  navbarNoBg: boolean
}

type Navigation = { label: string; href: string }

const navigation = await Astro.glob<{ navbar: Navigation[] }>(
  '../data/metadata.json'
)

const [{ navbar }] = navigation

const { navbarNoBg } = Astro.props as Props

const url = new URL(Astro.request.url)
const currentPage = url.pathname

const pagesInNavbar = navbar.map((page) => ({
  label: page.label,
  href: page.href,
  active: page.href === currentPage
}))

const enableDarkMode =
  Astro.url.pathname.includes('/blog') ||
  Astro.url.pathname.includes('/clojure-in')
---

<Navbar
  client:visible
  navLinks={pagesInNavbar}
  enableDarkMode={enableDarkMode}
  navbarNoBg={navbarNoBg}
/>
